<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-baxB/HV16TkBHy6Dg8M79SCGlv6oLpCKC/Joa5H4SSz7r0ZF4RHJrh8p+9S3GrfoeOst9dyeGOpqiNIVBae1jA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <title>Food and Drink List</title>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <h5 style="color: #ffffff;">Starbhak Mart</h5>
                    </li>
                </ul>
            </div>  
            <div>
                <span class="d-flex cari" id="cari">
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search" id="searchInput">
                    <button class="btn btn-outline-success" type="submit"><img src="search-interface-symbol (1).png" class="card-img-top" alt="..."></button>
                </span>
            </div>
    </nav>

    <!-- Sidebar -->
    <div class="container-fluid" style="background-color: rgb(236, 212, 232);">
        <div class="row">
            <nav class="col-md-2 d-none d-md-block sidebar">
                <div id="sidebarContent" class="sidebar-sticky">
                    <br>
                    <ul class="list-group">
                        <div class="dropdown">
                            <select class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton"
                                style="margin-left: 25px;">
                                <option hidden value="" style="text-align: center;">Pilih Jenis Pemesanan</option>
                                <option value="Takeaway" style="text-align: center;">Take Away</option>
                                <option value="Dine in" style="text-align: center;">Dine in</option>
                            </select>
                        </div>
                    </ul>
                    <br>
                    <hr>
                    <div>
                        <h2 style="text-align: center;">Keranjang</h2>
                        <ul id="cart-list" class="list-group">

                        </ul>
                    </div>

                    <!-- untuk pesanan -->
                    <hr>
                    <div class="Jajan" id="section-to-print">
                        <p>Discount : </p>
                        <p id="" style="display: none;">Test</p>
                        <p style="display: flex; justify-content: space-between;">Pajak : <span
                                id="taxDiscount">0</span></p>
                        <div class="bayar">
                            <p style="display: flex; justify-content: space-between;">Total Harga : <span
                                    id="totalAmount">0</span></p>
                        </div>
                        <button id="buyButton" type="button" class="btn btn-info"
                            style="width: 200px; margin-left: 25px;">Buy</button>
                    </div>
                </nav>

                <!-- Menu Pesanan -->

                <!-- Row -->
                <main role="main" class="col-md-10 px-4">
                    <div class="content">
                        <h2>Menu</h2>
                        <div class="row">
                            <div class="col-md-2">
                                <div class="card">
                                    <img src="ayam bakar.jpg" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title">Ayam bakar</h5>
                                        <p class="card-text">Rp.35.000</p>
                                        <button class="btn btn-success">Add</button>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-2">
                                <div class="card">
                                    <img src="nasi goreng.jpg" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title">nasi goreng</h5>
                                        <p class="card-text">Rp.18.000</p>
                                        <button class="btn btn-success">Add</button>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-2">
                                <div class="card">
                                    <img src="ikan bakar.jpg" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title">ikan bakar</h5>
                                        <p class="card-text">Rp.26.000</p>
                                        <button class="btn btn-success">Add</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="card">
                                    <img src="pecel ayam.jpg" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title">pecel ayam</h5>
                                        <p class="card-text">Rp.20.000</p>
                                        <button class="btn btn-success">Add</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="card">
                                    <img src="ketoprak.jpg" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title">ketoprak</h5>
                                        <p class="card-text">Rp.16.000</p>
                                        <button class="btn btn-success">Add</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="card">
                                    <img src="gado gado.jpg" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title">gado gado</h5>
                                        <p class="card-text">Rp.15.000</p>
                                        <button class="btn btn-success">Add</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Row 2 -->
                    <div class="content">
                        <div class="row">
                            <div class="col-md-2">
                                <div class="card">
                                    <img src="pristine.jpg" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title">pristine</h5>
                                        <p class="card-text">Rp.6.000</p>
                                        <button class="btn btn-success">Add</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="card">
                                    <img src="ichi ocha.jpg" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title">ichi ocha</h5>
                                        <p class="card-text">Rp.7.000</p>
                                        <button class="btn btn-success">Add</button>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-2">
                                <div class="card">
                                    <img src="the pucuk.jpg" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title">teh pucuk</h5>
                                        <p class="card-text">Rp.5.000</p>
                                        <button class="btn btn-success">Add</button>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-2">
                                <div class="card">
                                    <img src="fruit tea.jpg" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title">fruit tea</h5>
                                        <p class="card-text">Rp.8000</p>
                                        <button class="btn btn-success">Add</button>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-2">
                                <div class="card">
                                    <img src="ichitan.jpg" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title">ichitan</h5>
                                        <p class="card-text">Rp.7000</p>
                                        <button class="btn btn-success">Add</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="card">
                                    <img src="aqua.jpg" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title">aqua</h5>
                                        <p class="card-text">Rp.5000</p>
                                        <button class="btn btn-success">Add</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>

        <!-- Scripts -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

        <script src="sc.js"></script>
        <script src="buy.js"></script>
        <script src="search.js"></script>
    </body>
    <script>
        $(document).ready(function () {
    var itemQuantity = {};
    var initialItemPrices = {};

    function calculateTotalAfterTax(totalBeforeTax) {
        var tax = totalBeforeTax * 0.1;
        var totalAfterTax = totalBeforeTax + tax;
        return {
            tax: tax,
            totalAfterTax: totalAfterTax
        };
    }

    function updateTotal(total) {
        $('#totalAmount').text('Rp. ' + total.toLocaleString('id-ID'));
    }

    function updateTax(tax) {
        $('#taxDiscount').text('Rp. ' + tax.toLocaleString('id-ID'));
    }

    function updateTotalAmount(totalAmount) {
        $('#totalAmount').text('Rp. ' + totalAmount.toLocaleString('id-ID'));
    }

    function updateItemTotalPrice(formattedItemName) {
        var itemTotalPrice = initialItemPrices[formattedItemName] * itemQuantity[formattedItemName];
        $('#total_' + formattedItemName).text('Rp. ' + itemTotalPrice.toLocaleString('id-ID'));
    }

    function updateTotalAfterQuantityChange() {
        var totalPrice = 0;
        for (var item in itemQuantity) {
            totalPrice += initialItemPrices[item] * itemQuantity[item];
            updateItemTotalPrice(item);
        }

        var { tax, totalAfterTax } = calculateTotalAfterTax(totalPrice);
        updateTotal(totalPrice);
        updateTax(tax);
        updateTotalAmount(totalAfterTax);
    }

    // tombol "Add"
    $('.btn-success').on('click', function () {
        var $clickedItem = $(this).closest('.card');
        var itemName = $clickedItem.find('.card-title').text().trim();
        var itemPriceText = $clickedItem.find('.card-text').text().trim();
        var itemPrice = parseFloat(itemPriceText.replace('Rp.', '').replace('.', '').replace(',', '.'));

        if (!isNaN(itemPrice)) {
            var formattedItemName = itemName.replace(/\s+/g, '_').toLowerCase();

            if (!itemQuantity[formattedItemName]) {
                itemQuantity[formattedItemName] = 1;
                initialItemPrices[formattedItemName] = itemPrice;
                var newElement = `
                    <li class="list-group-item">
                        <div class="barang">
                            <div class="detail-kiri">
                                <p>${itemName}</p>
                                <p class="normal">Unit Price: Rp. ${itemPrice.toLocaleString('id-ID')}</p>
                            </div>
                            <div class="detail-kanan">
                                <p style="text-align: right; font-size: small;"> <span class="item-total" id="total_${formattedItemName}">${itemPrice.toLocaleString('id-ID')}</span></p>
                                <p class="normal" style="display: flex; justify-content: space-between;">
                                    Quantity: <span class="stock" id="stock_${formattedItemName}">${itemQuantity[formattedItemName]}</span>
                                </p>
                            </div>
                            <button class="btn btn-danger remove">
                                <span class="material-symbols-outlined">Delete</span>
                            </button>
                        </div>
                    </li>
                `;
                $('#cart-list').append(newElement);
                updateTotalAfterQuantityChange();
            } else {
                itemQuantity[formattedItemName]++;
                $('#stock_' + formattedItemName).text(itemQuantity[formattedItemName]);
                updateItemTotalPrice(formattedItemName);
                updateTotalAfterQuantityChange();
            }
        } else {
            console.error('Harga item tidak valid');
        }
    });

    //tombol "Remove"
    $('#cart-list').on('click', '.remove', function () {
        var $item = $(this).closest('.list-group-item');
        var itemName = $item.find('.detail-kiri p').first().text().trim();
        var formattedItemName = itemName.replace(/\s+/g, '_').toLowerCase();

        if (itemQuantity[formattedItemName] > 1) {
            itemQuantity[formattedItemName]--;
            $('#stock_' + formattedItemName).text(itemQuantity[formattedItemName]);
            updateItemTotalPrice(formattedItemName);
        } else {
            delete itemQuantity[formattedItemName];
            $item.remove();
        }

        updateTotalAfterQuantityChange();
    });

    $('#buyButton').on('click', function () {
                // Memanggil fungsi untuk menampilkan notifikasi
                showThankYouNotification();
            });

            // Fungsi untuk menampilkan notifikasi terima kasih
            function showThankYouNotification() {
                swal({
                    title: "Terima kasih!",
                    text: "Terima kasih telah membeli di Starbhak Mart!",
                    icon: "success",
                }).then((value) => {
                    // Jika pengguna mengklik "OK" pada notifikasi
                    if (value) {
                        // Redirect ke halaman proses
                        window.location.href = "halaman_proses.html";
                    }
                });
            }
        });
    </script>

</html>